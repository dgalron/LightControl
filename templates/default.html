
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Lights</title>
    <!--Cover template for Bootstrap, by @mdo.-->
    <!-- Bootstrap core CSS -->
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
      <!-- Custom styles for this template -->
    <link href="static/cover.css" rel="stylesheet">
  </head>
  <body>
    <div class="site-wrapper">
      <div class="site-wrapper-inner">
        <div class="cover-container">

          <div class="inner cover">
            <h1 class="cover-heading">Control the lights.</h1>
            <p class="lead">Daniel and Clair invite you to mess with their lights.</p>
            <p class="lead">
                <!-- Single button -->
                <div class="btn-group" style="width:30%;">
                  <button type="button" class="btn btn-lg btn-default dropdown-toggle" data-toggle="dropdown">
                    POWER <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu">
                    <li><a href="#" id="power-on">ON</a></li>
                    <li><a href="#" id="power-off">OFF</a></li>
                  </ul>
                </div>
            </p>
          </div>

          <div class="mastfoot">
            <div class="inner">
            </div>
          </div>

        </div>

      </div>

    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script>


        $("#power-on").click(function(e){
            var data = { power_state : 1 };
            var url = document.URL.split('#')[0] + "api/power";

            send_request(url, data);

            e.preventDefault();
        });
        $("#power-off").click(function(e){
            var data = { power_state : 0 };
            var url = document.URL.split('#')[0] + "api/power";

            send_request(url, data);

            e.preventDefault();
        });

        var send_request = function(url, data) {
            $.ajax({
              type: "POST",
              url: url,
              data: JSON.stringify(data),
              contentType: "application/json; charset=utf-8",
            }).fail(function() {
                alert("oh noes! There was an error.");
            }).done(function(resp) {
              //alert(resp.power);
            });
        }
    </script>
  </body>
</html>
